<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FB账户管理 - BestAds Admin</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    .sidebar-item {
      position: relative;
      transition: all 0.2s ease;
    }

    .sidebar-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: #667eea;
      transform: scaleY(0);
      transition: transform 0.2s ease;
    }

    .sidebar-item.active::before,
    .sidebar-item:hover::before {
      transform: scaleY(1);
    }

    .table-hover tbody tr:hover {
      background-color: #f9fafb;
    }

    .modal-backdrop {
      backdrop-filter: blur(8px);
    }

    .animate-fadeIn {
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }

    .mobile-menu-open {
      transform: translateX(0);
    }

    .mobile-menu-closed {
      transform: translateX(-100%);
    }

    .status-active { background-color: #10b981; color: white; }
    .status-limited { background-color: #f59e0b; color: white; }
    .status-banned { background-color: #ef4444; color: white; }
    .status-pending { background-color: #6b7280; color: white; }

    .balance-display {
      font-family: 'Courier New', monospace;
      font-weight: 600;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="flex h-screen overflow-hidden">
    <!-- 侧边栏 -->
    <aside id="sidebar" class="bg-white w-64 min-h-screen shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 mobile-menu-closed lg:mobile-menu-open fixed z-30">
      <!-- 侧边栏头部 -->
      <div class="flex items-center justify-center h-16 border-b border-gray-200">
        <div class="flex items-center">
          <div class="w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center">
            <i class="fas fa-chart-line text-white text-sm"></i>
          </div>
          <span class="ml-3 text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
            BestAds Admin
          </span>
        </div>
      </div>

      <!-- 侧边栏菜单 -->
      <nav class="mt-8">
        <!-- 主要功能 -->
        <div class="px-4 mb-6">
          <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">主要功能</h3>
          <ul class="space-y-1">
            <li>
              <a href="index.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-chart-bar w-5 h-5 mr-3 text-gray-400"></i>
                仪表盘
              </a>
            </li>
            <li>
              <a href="customer-management.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-users w-5 h-5 mr-3 text-gray-400"></i>
                客户管理
              </a>
            </li>
          </ul>
        </div>

        <!-- FB业务管理 -->
        <div class="px-4 mb-6">
          <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">FB业务管理</h3>
          <ul class="space-y-1">
            <li>
              <a href="#" class="sidebar-item active flex items-center px-4 py-2 text-sm font-medium text-gray-900 rounded-lg hover:bg-gray-100">
                <i class="fas fa-sync w-5 h-5 mr-3 text-gray-500"></i>
                账户管理
              </a>
            </li>
            <li>
              <a href="account-opening.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-plus-circle w-5 h-5 mr-3 text-gray-400"></i>
                开户管理
              </a>
            </li>
            <li>
              <a href="account-allocation.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-clipboard-list w-5 h-5 mr-3 text-gray-400"></i>
                账户分配
              </a>
            </li>
            <li>
              <a href="recharge-management.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-dollar-sign w-5 h-5 mr-3 text-gray-400"></i>
                充值管理
              </a>
            </li>
          </ul>
        </div>

        <!-- 客户流水 -->
        <div class="px-4 mb-6">
          <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">客户流水</h3>
          <ul class="space-y-1">
            <li><a href="customer-transactions/transaction-detail.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">交易明细</a></li>
            <li><a href="customer-transactions/online-recharge.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">在线充值</a></li>
            <li><a href="customer-transactions/offline-transfer.html" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">线下转账</a></li>
          </ul>
        </div>

        <!-- 系统设置 -->
        <div class="px-4">
          <h3 class="text-xs font-semibold text-gray-400 uppercase tracking-wider mb-3">系统设置</h3>
          <ul class="space-y-1">
            <li>
              <a href="#" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-cog w-5 h-5 mr-3 text-gray-400"></i>
                系统配置
              </a>
            </li>
            <li>
              <a href="#" class="sidebar-item flex items-center px-4 py-2 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-100 hover:text-gray-900">
                <i class="fas fa-user-cog w-5 h-5 mr-3 text-gray-400"></i>
                用户管理
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </aside>

    <!-- 遮罩层 (移动端) -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-gray-600 bg-opacity-50 opacity-0 hidden z-20 transition-opacity duration-300 ease-linear lg:hidden"></div>

    <!-- 主要内容区域 -->
    <div class="flex flex-col flex-1 overflow-hidden">
      <!-- 顶部栏 -->
      <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8">
          <!-- 左侧 -->
          <div class="flex items-center">
            <button onclick="toggleSidebar()" class="lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500">
              <i class="fas fa-bars text-lg"></i>
            </button>
            
            <div class="ml-4 lg:ml-0">
              <nav class="flex space-x-2 text-sm" aria-label="Breadcrumb">
                <span class="text-gray-500">主页</span>
                <i class="fas fa-chevron-right text-gray-300 text-xs mt-0.5"></i>
                <span class="text-gray-500">FB业务管理</span>
                <i class="fas fa-chevron-right text-gray-300 text-xs mt-0.5"></i>
                <span class="text-gray-900 font-medium">账户管理</span>
              </nav>
            </div>
          </div>
          
          <!-- 右侧 -->
          <div class="flex items-center space-x-4">
            <div class="relative">
              <button class="p-2 text-gray-400 hover:text-gray-500 relative">
                <i class="fas fa-bell text-lg"></i>
                <span class="absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full flex items-center justify-center text-xs text-white">3</span>
              </button>
            </div>
            
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center">
                <span class="text-white text-sm font-medium">A</span>
              </div>
              <span class="hidden md:block text-sm font-medium text-gray-700">管理员</span>
            </div>
          </div>
        </div>
      </header>

      <!-- 页面内容 -->
      <main class="flex-1 overflow-y-auto bg-gray-50">
        <div class="py-6">
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- 页面标题区域 -->
            <div class="mb-8">
              <div class="md:flex md:items-center md:justify-between">
                <div class="flex-1 min-w-0">
                  <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate">
                    FB账户管理
                  </h2>
                  <p class="mt-1 text-sm text-gray-500">
                    管理公司全部Facebook广告账户信息，通过Token同步账户数据
                  </p>
                </div>
                <div class="mt-4 flex md:mt-0 md:ml-4 space-x-3">
                  <button onclick="syncAccounts()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center space-x-2">
                    <i class="fas fa-sync-alt"></i>
                    <span>同步账户</span>
                  </button>
                  <button onclick="exportData()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center space-x-2">
                    <i class="fas fa-download"></i>
                    <span>导出数据</span>
                  </button>
                </div>
              </div>
            </div>

            <!-- 筛选区域 -->
            <div class="bg-white shadow-sm rounded-lg border border-gray-200 mb-6">
              <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">筛选条件</h3>
              </div>
              <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">广告账户ID</label>
                    <input type="text" id="filterAccountId" placeholder="输入账户ID" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">广告账户名称</label>
                    <input type="text" id="filterAccountName" placeholder="输入账户名称" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">状态</label>
                    <select id="filterStatus" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                      <option value="">全部状态</option>
                      <option value="active">活跃</option>
                      <option value="limited">受限</option>
                      <option value="banned">被封</option>
                      <option value="pending">待审核</option>
                    </select>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">币种</label>
                    <select id="filterCurrency" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                      <option value="">全部币种</option>
                      <option value="USD">USD</option>
                      <option value="EUR">EUR</option>
                      <option value="GBP">GBP</option>
                      <option value="CNY">CNY</option>
                    </select>
                  </div>
                </div>
                <div class="flex justify-between items-center mt-4">
                  <button onclick="searchAccounts()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md font-medium transition-colors duration-200">
                    <i class="fas fa-search mr-2"></i>搜索
                  </button>
                  <div class="flex space-x-2">
                    <button onclick="resetFilters()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-md font-medium transition-colors duration-200">
                      <i class="fas fa-redo mr-2"></i>重置
                    </button>
                    <button onclick="openCustomizeFields()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md font-medium transition-colors duration-200">
                      <i class="fas fa-cog mr-2"></i>自定义字段
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- 账户列表表格 -->
            <div class="bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden">
              <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                <h3 class="text-lg font-medium text-gray-900">账户列表</h3>
                <div class="text-sm text-gray-500">
                  共 <span class="font-medium text-gray-900" id="totalCount">342</span> 个账户
                </div>
              </div>
              <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200 table-hover">
                  <thead class="bg-gray-50" id="tableHead">
                    <!-- 动态表头将在这里生成 -->
                  </thead>
                  <tbody class="bg-white divide-y divide-gray-200" id="accountTableBody">
                    <!-- 动态表格内容将在这里生成 -->
                  </tbody>
                </table>
              </div>
              
              <!-- 分页 -->
              <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                <div class="flex items-center space-x-4">
                  <div class="flex items-center space-x-2">
                    <label class="text-sm text-gray-700">每页显示:</label>
                    <select id="pageSize" class="px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                      <option value="10">10</option>
                      <option value="20" selected>20</option>
                      <option value="50">50</option>
                      <option value="100">100</option>
                    </select>
                  </div>
                  <div class="hidden sm:block">
                    <p class="text-sm text-gray-700">
                      显示 <span class="font-medium">1</span> 到 <span class="font-medium">20</span> 共 <span class="font-medium">342</span> 条结果
                    </p>
                  </div>
                </div>
                <div>
                  <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                    <button class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                      <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="bg-blue-50 border-blue-500 text-blue-600 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                      1
                    </button>
                    <button class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                      2
                    </button>
                    <button class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                      3
                    </button>
                    <button class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                      <i class="fas fa-chevron-right"></i>
                    </button>
                  </nav>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- 字段自定义模态框 -->
  <div id="customizeFieldsModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 modal-backdrop hidden z-50">
    <div class="flex items-center justify-center min-h-screen px-4">
      <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full animate-fadeIn">
        <div class="px-6 py-4 border-b border-gray-200">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-medium text-gray-900">自定义列表字段</h3>
            <button onclick="closeModal('customizeFieldsModal')" class="text-gray-400 hover:text-gray-600">
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>
        <div class="px-6 py-4">
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- 可用字段 -->
            <div>
              <h4 class="text-sm font-medium text-gray-900 mb-3">可用字段</h4>
              <div class="border border-gray-200 rounded-lg p-4 h-80 overflow-y-auto">
                <ul id="availableFields" class="space-y-2">
                  <!-- 动态生成可用字段 -->
                </ul>
              </div>
            </div>
            
            <!-- 已选字段 -->
            <div>
              <h4 class="text-sm font-medium text-gray-900 mb-3">已选字段（可拖拽排序）</h4>
              <div class="border border-gray-200 rounded-lg p-4 h-80 overflow-y-auto">
                <ul id="selectedFields" class="space-y-2">
                  <!-- 动态生成已选字段 -->
                </ul>
              </div>
            </div>
          </div>
          
          <div class="flex justify-between items-center mt-6">
            <div class="flex space-x-2">
              <button onclick="resetToDefault()" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors duration-200">
                重置为默认
              </button>
            </div>
            <div class="flex space-x-3">
              <button onclick="closeModal('customizeFieldsModal')" class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors duration-200">
                取消
              </button>
              <button onclick="applyFieldSettings()" class="px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors duration-200">
                应用设置
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 全局变量
    let allFields = [
      { key: 'accountId', label: '广告账户ID', width: '150px' },
      { key: 'accountName', label: '广告账户名称', width: '200px' },
      { key: 'status', label: '状态', width: '100px' },
      { key: 'timezone', label: '时区', width: '150px' },
      { key: 'currency', label: '币种', width: '80px' },
      { key: 'balance', label: '余额', width: '120px' },
      { key: 'totalSpent', label: '总消耗', width: '120px' },
      { key: 'spendLimit', label: '消耗上限', width: '120px' },
      { key: 'createdDays', label: '创建天数', width: '100px' },
      { key: 'createdTime', label: '创建时间', width: '150px' },
      { key: 'businessManager', label: '所属BM', width: '150px' },
      { key: 'mediaAgency', label: '媒体代理', width: '130px' },
      { key: 'ownerId', label: '所有者ID', width: '130px' },
      { key: 'banReason', label: '被封原因', width: '150px' },
      { key: 'openingAgency', label: '开户代理', width: '120px' }
    ];

    // 默认显示的字段
    let defaultFields = ['accountId', 'accountName', 'status', 'currency', 'balance', 'totalSpent', 'createdTime'];
    
    // 当前显示的字段
    let currentFields = [...defaultFields];

    // 模拟账户数据
    let accountData = [
      {
        accountId: 'act_1234567890',
        accountName: 'ABC科技有限公司广告账户',
        status: 'active',
        timezone: 'Asia/Shanghai',
        currency: 'USD',
        balance: 15680.50,
        totalSpent: 98765.32,
        spendLimit: 50000.00,
        createdDays: 126,
        createdTime: '2023-10-15 14:30:25',
        businessManager: 'BM_ABC科技',
        mediaAgency: 'Meta一级代理A',
        ownerId: 'user_abc123456',
        banReason: '',
        openingAgency: 'BestAds开户部'
      },
      {
        accountId: 'act_0987654321',
        accountName: 'XYZ数字营销推广账户',
        status: 'limited',
        timezone: 'America/New_York',
        currency: 'USD',
        balance: 2350.75,
        totalSpent: 45678.90,
        spendLimit: 25000.00,
        createdDays: 89,
        createdTime: '2023-11-28 09:15:42',
        businessManager: 'BM_XYZ营销',
        mediaAgency: 'Meta一级代理B',
        ownerId: 'user_xyz789012',
        banReason: '',
        openingAgency: 'BestAds开户部'
      },
      {
        accountId: 'act_1122334455',
        accountName: '创新广告公司FB账户',
        status: 'banned',
        timezone: 'Europe/London',
        currency: 'EUR',
        balance: 0.00,
        totalSpent: 12345.67,
        spendLimit: 10000.00,
        createdDays: 45,
        createdTime: '2024-01-20 16:45:33',
        businessManager: 'BM_创新广告',
        mediaAgency: 'Meta一级代理C',
        ownerId: 'user_inn345678',
        banReason: '违反政策：误导性内容',
        openingAgency: 'BestAds开户部'
      },
      {
        accountId: 'act_5566778899',
        accountName: '电商推广专用账户',
        status: 'active',
        timezone: 'Asia/Tokyo',
        currency: 'USD',
        balance: 8925.40,
        totalSpent: 156789.12,
        spendLimit: 75000.00,
        createdDays: 234,
        createdTime: '2023-07-10 11:22:18',
        businessManager: 'BM_电商集团',
        mediaAgency: 'Meta一级代理A',
        ownerId: 'user_ecom901234',
        banReason: '',
        openingAgency: 'BestAds开户部'
      },
      {
        accountId: 'act_9988776655',
        accountName: '游戏推广营销账户',
        status: 'pending',
        timezone: 'Asia/Shanghai',
        currency: 'USD',
        balance: 5000.00,
        totalSpent: 0.00,
        spendLimit: 30000.00,
        createdDays: 3,
        createdTime: '2024-03-12 13:45:27',
        businessManager: 'BM_游戏工作室',
        mediaAgency: 'Meta一级代理B',
        ownerId: 'user_game567890',
        banReason: '',
        openingAgency: 'BestAds开户部'
      }
    ];

    // 初始化页面
    document.addEventListener('DOMContentLoaded', function() {
      renderAccountTable();
    });

    // 渲染账户表格
    function renderAccountTable(data = accountData) {
      renderTableHeader();
      renderTableBody(data);
    }

    // 渲染表头
    function renderTableHeader() {
      const tableHead = document.getElementById('tableHead');
      const headerRow = document.createElement('tr');
      
      currentFields.forEach(fieldKey => {
        const field = allFields.find(f => f.key === fieldKey);
        if (field) {
          const th = document.createElement('th');
          th.className = 'px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider';
          th.style.width = field.width;
          th.textContent = field.label;
          headerRow.appendChild(th);
        }
      });
      
      tableHead.innerHTML = '';
      tableHead.appendChild(headerRow);
    }

    // 渲染表格内容
    function renderTableBody(data) {
      const tableBody = document.getElementById('accountTableBody');
      tableBody.innerHTML = '';
      
      data.forEach(account => {
        const row = document.createElement('tr');
        
        currentFields.forEach(fieldKey => {
          const td = document.createElement('td');
          td.className = 'px-6 py-4 whitespace-nowrap';
          
          switch(fieldKey) {
            case 'accountId':
              td.innerHTML = `<div class="text-sm font-medium text-gray-900">${account.accountId}</div>`;
              break;
            case 'accountName':
              td.innerHTML = `<div class="text-sm text-gray-900">${account.accountName}</div>`;
              break;
            case 'status':
              td.innerHTML = `<span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusClass(account.status)}">${getStatusText(account.status)}</span>`;
              break;
            case 'timezone':
              td.innerHTML = `<div class="text-sm text-gray-500">${account.timezone}</div>`;
              break;
            case 'currency':
              td.innerHTML = `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800">${account.currency}</span>`;
              break;
            case 'balance':
              td.innerHTML = `<div class="text-sm balance-display ${account.balance > 0 ? 'text-green-600' : 'text-red-600'}">${formatNumber(account.balance)}</div>`;
              break;
            case 'totalSpent':
              td.innerHTML = `<div class="text-sm balance-display text-gray-900">${formatNumber(account.totalSpent)}</div>`;
              break;
            case 'spendLimit':
              td.innerHTML = `<div class="text-sm balance-display text-gray-500">${formatNumber(account.spendLimit)}</div>`;
              break;
            case 'createdDays':
              td.innerHTML = `<div class="text-sm text-gray-500">${account.createdDays} 天</div>`;
              break;
            case 'createdTime':
              td.innerHTML = `<div class="text-sm text-gray-500">${account.createdTime}</div>`;
              break;
            case 'businessManager':
              td.innerHTML = `<div class="text-sm text-gray-900">${account.businessManager}</div>`;
              break;
            case 'mediaAgency':
              td.innerHTML = `<div class="text-sm text-gray-900">${account.mediaAgency}</div>`;
              break;
            case 'ownerId':
              td.innerHTML = `<div class="text-sm text-gray-500">${account.ownerId}</div>`;
              break;
            case 'banReason':
              td.innerHTML = `<div class="text-sm ${account.banReason ? 'text-red-600' : 'text-gray-500'}">${account.banReason || '-'}</div>`;
              break;
            case 'openingAgency':
              td.innerHTML = `<div class="text-sm text-gray-900">${account.openingAgency}</div>`;
              break;
          }
          
          row.appendChild(td);
        });
        
        tableBody.appendChild(row);
      });
      
      // 更新总数显示
      document.getElementById('totalCount').textContent = data.length;
    }

    // 获取状态样式类
    function getStatusClass(status) {
      const statusClasses = {
        'active': 'bg-green-100 text-green-800',
        'limited': 'bg-yellow-100 text-yellow-800',
        'banned': 'bg-red-100 text-red-800',
        'pending': 'bg-gray-100 text-gray-800'
      };
      return statusClasses[status] || 'bg-gray-100 text-gray-800';
    }

    // 获取状态文本
    function getStatusText(status) {
      const statusTexts = {
        'active': '活跃',
        'limited': '受限',
        'banned': '被封',
        'pending': '待审核'
      };
      return statusTexts[status] || status;
    }

    // 格式化数字（不带货币符号）
    function formatNumber(amount) {
      return amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    // 打开字段自定义
    function openCustomizeFields() {
      renderFieldCustomization();
      document.getElementById('customizeFieldsModal').classList.remove('hidden');
    }

    // 渲染字段自定义界面
    function renderFieldCustomization() {
      const availableFields = document.getElementById('availableFields');
      const selectedFields = document.getElementById('selectedFields');
      
      // 清空现有内容
      availableFields.innerHTML = '';
      selectedFields.innerHTML = '';
      
      // 渲染可用字段（未选中的）
      allFields.forEach(field => {
        if (!currentFields.includes(field.key)) {
          const li = createFieldItem(field, false);
          availableFields.appendChild(li);
        }
      });
      
      // 渲染已选字段（按当前顺序）
      currentFields.forEach(fieldKey => {
        const field = allFields.find(f => f.key === fieldKey);
        if (field) {
          const li = createFieldItem(field, true);
          selectedFields.appendChild(li);
        }
      });
      
      // 启用拖拽排序
      enableSortable();
    }

    // 创建字段项
    function createFieldItem(field, isSelected) {
      const li = document.createElement('li');
      li.className = `flex items-center justify-between p-2 border border-gray-200 rounded-md cursor-pointer hover:bg-gray-50 ${isSelected ? 'selected-field' : 'available-field'}`;
      li.dataset.fieldKey = field.key;
      
      li.innerHTML = `
        <div class="flex items-center">
          ${isSelected ? '<i class="fas fa-grip-vertical text-gray-400 mr-2"></i>' : ''}
          <span class="text-sm text-gray-900">${field.label}</span>
        </div>
        <button onclick="toggleField('${field.key}', ${isSelected})" class="text-sm ${isSelected ? 'text-red-600 hover:text-red-800' : 'text-blue-600 hover:text-blue-800'}">
          ${isSelected ? '移除' : '添加'}
        </button>
      `;
      
      return li;
    }

    // 切换字段选择状态
    function toggleField(fieldKey, isSelected) {
      if (isSelected) {
        // 移除字段
        currentFields = currentFields.filter(key => key !== fieldKey);
      } else {
        // 添加字段
        currentFields.push(fieldKey);
      }
      
      renderFieldCustomization();
    }

    // 启用拖拽排序
    function enableSortable() {
      const selectedFieldsList = document.getElementById('selectedFields');
      let draggedElement = null;
      
      selectedFieldsList.addEventListener('dragstart', function(e) {
        draggedElement = e.target.closest('li');
        e.target.style.opacity = '0.5';
      });
      
      selectedFieldsList.addEventListener('dragend', function(e) {
        e.target.style.opacity = '';
        draggedElement = null;
      });
      
      selectedFieldsList.addEventListener('dragover', function(e) {
        e.preventDefault();
      });
      
      selectedFieldsList.addEventListener('drop', function(e) {
        e.preventDefault();
        const targetElement = e.target.closest('li');
        
        if (draggedElement && targetElement && draggedElement !== targetElement) {
          const draggedIndex = Array.from(selectedFieldsList.children).indexOf(draggedElement);
          const targetIndex = Array.from(selectedFieldsList.children).indexOf(targetElement);
          
          // 更新currentFields顺序
          const draggedFieldKey = currentFields[draggedIndex];
          currentFields.splice(draggedIndex, 1);
          currentFields.splice(targetIndex, 0, draggedFieldKey);
          
          // 重新渲染
          renderFieldCustomization();
        }
      });
      
      // 为每个字段项添加draggable属性
      selectedFieldsList.querySelectorAll('li').forEach(li => {
        li.draggable = true;
      });
    }

    // 重置为默认字段
    function resetToDefault() {
      currentFields = [...defaultFields];
      renderFieldCustomization();
    }

    // 应用字段设置
    function applyFieldSettings() {
      renderAccountTable();
      closeModal('customizeFieldsModal');
      showNotification('字段设置已应用！', 'success');
    }

    // 模态框操作
    function closeModal(modalId) {
      document.getElementById(modalId).classList.add('hidden');
    }

    // 点击模态框外部关闭
    document.addEventListener('click', function(event) {
      if (event.target.classList.contains('modal-backdrop')) {
        event.target.classList.add('hidden');
      }
    });

    // 搜索账户
    function searchAccounts() {
      const accountId = document.getElementById('filterAccountId').value.toLowerCase();
      const accountName = document.getElementById('filterAccountName').value.toLowerCase();
      const status = document.getElementById('filterStatus').value;
      const currency = document.getElementById('filterCurrency').value;
      
      const filtered = accountData.filter(account => {
        return (!accountId || account.accountId.toLowerCase().includes(accountId)) &&
               (!accountName || account.accountName.toLowerCase().includes(accountName)) &&
               (!status || account.status === status) &&
               (!currency || account.currency === currency);
      });
      
      renderAccountTable(filtered);
      showNotification(`搜索完成，找到 ${filtered.length} 个匹配的账户`, 'info');
    }

    // 重置筛选条件
    function resetFilters() {
      document.getElementById('filterAccountId').value = '';
      document.getElementById('filterAccountName').value = '';
      document.getElementById('filterStatus').value = '';
      document.getElementById('filterCurrency').value = '';
      
      renderAccountTable();
      showNotification('筛选条件已重置', 'info');
    }

    // 同步账户
    function syncAccounts() {
      showNotification('正在同步账户数据...', 'info');
      
      // 模拟API调用
      setTimeout(() => {
        showNotification('账户数据同步完成！', 'success');
        renderAccountTable();
      }, 2000);
    }

    // 导出数据
    function exportData() {
      showNotification('正在准备导出数据...', 'info');
      
      // 模拟导出功能
      setTimeout(() => {
        showNotification('数据导出完成！', 'success');
      }, 1500);
    }

    // 侧边栏切换
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebar-overlay');
      
      if (sidebar.classList.contains('mobile-menu-closed')) {
        sidebar.classList.remove('mobile-menu-closed');
        sidebar.classList.add('mobile-menu-open');
        overlay.classList.remove('hidden');
        overlay.classList.remove('opacity-0');
        overlay.classList.add('opacity-50');
      } else {
        sidebar.classList.remove('mobile-menu-open');
        sidebar.classList.add('mobile-menu-closed');
        overlay.classList.add('opacity-0');
        overlay.classList.remove('opacity-50');
        setTimeout(() => {
          overlay.classList.add('hidden');
        }, 300);
      }
    }

    // 点击遮罩层关闭侧边栏
    document.getElementById('sidebar-overlay').addEventListener('click', function() {
      toggleSidebar();
    });

    // 菜单项切换
    document.querySelectorAll('.sidebar-item').forEach(item => {
      item.addEventListener('click', function(e) {
        if (this.getAttribute('href') === '#') {
          e.preventDefault();
        }
        document.querySelectorAll('.sidebar-item').forEach(menu => menu.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // 每页显示数量变更
    document.getElementById('pageSize').addEventListener('change', function() {
      const pageSize = this.value;
      showNotification(`每页显示条数已调整为: ${pageSize}`, 'info');
    });

    // 响应式处理
    window.addEventListener('resize', function() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('sidebar-overlay');
      
      if (window.innerWidth >= 1024) {
        sidebar.classList.remove('mobile-menu-closed');
        sidebar.classList.add('mobile-menu-open');
        overlay.classList.add('hidden');
        overlay.classList.add('opacity-0');
        overlay.classList.remove('opacity-50');
      }
    });

    // 通知函数
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `fixed top-20 right-4 z-50 max-w-sm w-full bg-white shadow-lg rounded-lg pointer-events-auto transform transition-all duration-300 translate-x-full`;
      
      const typeColors = {
        'info': 'border-blue-400 text-blue-700',
        'success': 'border-green-400 text-green-700',
        'warning': 'border-yellow-400 text-yellow-700',
        'error': 'border-red-400 text-red-700'
      };
      
      const typeIcons = {
        'info': 'fas fa-info-circle',
        'success': 'fas fa-check-circle',
        'warning': 'fas fa-exclamation-triangle',
        'error': 'fas fa-times-circle'
      };
      
      notification.innerHTML = `
        <div class="rounded-lg shadow-lg border-l-4 ${typeColors[type]} p-4">
          <div class="flex">
            <div class="flex-shrink-0">
              <i class="${typeIcons[type]}"></i>
            </div>
            <div class="ml-3">
              <p class="text-sm font-medium">${message}</p>
            </div>
            <div class="ml-auto pl-3">
              <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        </div>
      `;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.classList.remove('translate-x-full');
      }, 100);
      
      setTimeout(() => {
        notification.classList.add('translate-x-full');
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }
  </script>
</body>
</html> 